1.
Найдите все отряды, у которых нет лидера.

SELECT *
FROM Squads
WHERE leader_id is NULL;

2.
Получите список всех гномов старше 150 лет, у которых
профессия "Warrior".

SELECT *
FROM Dwarves
WHERE age > 150
    AND profession = 'Warrior';

3.
Найдите гномов, у которых есть хотя бы один предмет типа
"weapon".

SELECT D.dwarf_id,
    D.name
FROM Dwarves AS D
INNER JOIN Items AS I ON D.dwarf_id = I.owner_id
WHERE I.type = 'weapon'
GROUP BY D.dwarf_id, D.name;

4.
Получите количество задач для каждого гнома, сгруппировав
их по статусу.

SELECT D.dwarf_id,
    D.name,
    T.status,
    COUNT(T.task_id) AS tasks_count
FROM Dwarves AS D
INNER JOIN Tasks AS T ON D.dwarf_id = T.assigned_to
GROUP BY D.dwarf_id, D.name, T.status;

5.
Найдите все задачи, которые были назначены гномам из отряда
с именем "Guardians".

SELECT *
FROM Tasks
WHERE assigned_to IN 
    (SELECT D.dwarf_id
    FROM Dwarves D
    INNER JOIN Squads S ON D.squad_id = S.squad_id
    WHERE S.name = 'Guardians');

6.
Выведите всех гномов и их ближайших родственников, указав
тип родственных отношений.

SELECT D1.dwarf_id,
    D1.name,
    R.related_to AS relative_id,
    D2.name AS relative_name,
    R.relationship
FROM Relationships AS R
INNER JOIN Dwarves AS D1 ON R.dwarf_id = D1.dwarf_id
INNER JOIN Dwarves AS D2 ON R.related_to = D2.dwarf_id;
